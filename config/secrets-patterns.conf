##############################################
# z3r0-toolkit — Secret Detection Patterns
# Format: PATTERN_NAME:::REGEX:::SEVERITY
# Severity: CRITICAL, HIGH, MEDIUM, LOW
##############################################

# ── AWS ──
AWS_ACCESS_KEY:::AKIA[0-9A-Z]{16}:::CRITICAL
AWS_SECRET_KEY:::[0-9a-zA-Z/+]{40}(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]):::CRITICAL
AWS_ACCOUNT_ID:::[0-9]{12}:::LOW
AWS_ARN:::arn:aws:[a-zA-Z0-9\-]+:[a-z]{2}-[a-z]+-[0-9]+:[0-9]{12}:::MEDIUM

# ── Google Cloud ──
GCP_API_KEY:::AIza[0-9A-Za-z\-_]{35}:::CRITICAL
GCP_SERVICE_ACCOUNT:::[a-zA-Z0-9\-]+@[a-zA-Z0-9\-]+\.iam\.gserviceaccount\.com:::HIGH
GCP_OAUTH_SECRET:::GOCSPX-[a-zA-Z0-9\-_]{28}:::CRITICAL

# ── Azure ──
AZURE_CLIENT_SECRET:::[a-zA-Z0-9~._\-]{34,40}:::HIGH
AZURE_STORAGE_KEY:::[A-Za-z0-9/+=]{86}==:::CRITICAL
AZURE_CONNECTION_STRING:::DefaultEndpointsProtocol=https;AccountName=[^;]+;AccountKey=[^;]+:::CRITICAL

# ── Firebase ──
FIREBASE_API_KEY:::AIza[0-9A-Za-z\-_]{35}:::HIGH
FIREBASE_URL:::https://[a-z0-9\-]+\.firebaseio\.com:::MEDIUM
FIREBASE_TOKEN:::[0-9]+:[0-9A-Za-z\-_]{140,}:::HIGH

# ── JWT / Auth Tokens ──
JWT_TOKEN:::eyJ[A-Za-z0-9\-_]+\.eyJ[A-Za-z0-9\-_]+\.[A-Za-z0-9\-_.+/=]+:::HIGH
BEARER_TOKEN:::Bearer\s+[A-Za-z0-9\-_\.~\+\/]+=*:::MEDIUM
BASIC_AUTH:::Basic\s+[A-Za-z0-9+/]{20,}={0,2}:::HIGH

# ── Stripe ──
STRIPE_SECRET_KEY:::sk_live_[0-9a-zA-Z]{24,}:::CRITICAL
STRIPE_PUBLISHABLE_KEY:::pk_live_[0-9a-zA-Z]{24,}:::MEDIUM
STRIPE_RESTRICTED_KEY:::rk_live_[0-9a-zA-Z]{24,}:::CRITICAL

# ── GitHub ──
GITHUB_TOKEN:::gh[pousr]_[0-9a-zA-Z]{36,}:::CRITICAL
GITHUB_OAUTH:::gho_[0-9a-zA-Z]{36}:::CRITICAL
GITHUB_APP_TOKEN:::ghu_[0-9a-zA-Z]{36}:::CRITICAL

# ── GitLab ──
GITLAB_TOKEN:::glpat-[0-9a-zA-Z\-_]{20,}:::CRITICAL

# ── Slack ──
SLACK_TOKEN:::xox[baprs]-[0-9a-zA-Z\-]{10,}:::CRITICAL
SLACK_WEBHOOK:::https://hooks\.slack\.com/services/T[A-Z0-9]+/B[A-Z0-9]+/[a-zA-Z0-9]+:::HIGH

# ── Twilio ──
TWILIO_ACCOUNT_SID:::AC[0-9a-fA-F]{32}:::HIGH
TWILIO_AUTH_TOKEN:::[0-9a-fA-F]{32}:::HIGH

# ── SendGrid ──
SENDGRID_API_KEY:::SG\.[0-9A-Za-z\-_]{22}\.[0-9A-Za-z\-_]{43}:::CRITICAL

# ── Mailgun ──
MAILGUN_API_KEY:::key-[0-9a-zA-Z]{32}:::CRITICAL

# ── PayPal ──
PAYPAL_ACCESS_TOKEN:::access_token\$[a-zA-Z0-9\.\$\-]+:::CRITICAL

# ── Square ──
SQUARE_ACCESS_TOKEN:::sq0atp-[0-9A-Za-z\-_]{22}:::CRITICAL
SQUARE_OAUTH_SECRET:::sq0csp-[0-9A-Za-z\-_]{43}:::CRITICAL

# ── Heroku ──
HEROKU_API_KEY:::[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}:::HIGH

# ── Database Connection Strings ──
POSTGRES_URI:::postgres(ql)?://[^\s'"]+:::CRITICAL
MYSQL_URI:::mysql://[^\s'"]+:::CRITICAL
MONGODB_URI:::mongodb(\+srv)?://[^\s'"]+:::CRITICAL
REDIS_URI:::redis://[^\s'"]+:::HIGH

# ── Private Keys ──
RSA_PRIVATE_KEY:::-----BEGIN RSA PRIVATE KEY-----:::CRITICAL
EC_PRIVATE_KEY:::-----BEGIN EC PRIVATE KEY-----:::CRITICAL
PGP_PRIVATE_KEY:::-----BEGIN PGP PRIVATE KEY BLOCK-----:::CRITICAL
OPENSSH_PRIVATE_KEY:::-----BEGIN OPENSSH PRIVATE KEY-----:::CRITICAL
GENERIC_PRIVATE_KEY:::-----BEGIN PRIVATE KEY-----:::CRITICAL

# ── Generic Secrets ──
PASSWORD_IN_URL:::://[^/\s]+:[^@/\s]+@:::HIGH
API_KEY_GENERIC:::[aA][pP][iI][-_]?[kK][eE][yY]\s*[:=]\s*['"]?[0-9a-zA-Z\-_]{16,}['"]?:::MEDIUM
SECRET_GENERIC:::[sS][eE][cC][rR][eE][tT]\s*[:=]\s*['"]?[0-9a-zA-Z\-_]{16,}['"]?:::MEDIUM
TOKEN_GENERIC:::[tT][oO][kK][eE][nN]\s*[:=]\s*['"]?[0-9a-zA-Z\-_]{16,}['"]?:::MEDIUM
PASSWORD_GENERIC:::[pP][aA][sS][sS]([wW][oO][rR][dD])?\s*[:=]\s*['"]?[^\s'"]{8,}['"]?:::HIGH

# ── Shopify ──
SHOPIFY_TOKEN:::shpat_[0-9a-fA-F]{32}:::CRITICAL
SHOPIFY_SHARED_SECRET:::shpss_[0-9a-fA-F]{32}:::CRITICAL

# ── Telegram ──
TELEGRAM_BOT_TOKEN:::[0-9]+:AA[0-9A-Za-z\-_]{33}:::HIGH

# ── Discord ──
DISCORD_TOKEN:::[MN][A-Za-z0-9]{23,}\.[A-Za-z0-9\-_]{6}\.[A-Za-z0-9\-_]{27,}:::CRITICAL
DISCORD_WEBHOOK:::https://discord(app)?\.com/api/webhooks/[0-9]+/[A-Za-z0-9\-_]+:::HIGH

# ══════════════════════════════════════════
# FALSE-POSITIVE EXCLUSIONS
# (Lines matching these patterns are ignored)
# Format: FP:::REGEX
# ══════════════════════════════════════════
FP:::AKIA(EXAMPLE|SAMPLE|TEST|FAKE|DUMMY|XXXX|0000)
FP:::['"]?(test|example|sample|dummy|fake|placeholder|changeme|your[_-]?api[_-]?key|insert[_-]?here|replace[_-]?me|todo|fixme|xxx+)['"]?
FP:::0{16,}
FP:::1{16,}
FP:::A{16,}
FP:::x{16,}
FP:::\*{8,}
FP:::\.{8,}
FP:::sk_test_
FP:::pk_test_
FP:::sk_live_xxxx
FP:::AKIAIOSFODNN7EXAMPLE
FP:::wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
FP:::password123
FP:::admin123
FP:::123456
FP::://\s*(TODO|FIXME|HACK|NOTE)
FP:::<!--.*-->
